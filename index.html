<!DOCTYPE html>
<html>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- we import arjs version without NFT but with marker + location-based support -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        /* CSS styles for the title */
        #ar-title {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.7);
            color: #ffffff;
            font-size: 24px;
            padding: 10px;
        }
    </style>
    <body style="margin: 0px; overflow: hidden;">
        <!-- AR Title -->
        <div id="ar-title">AR Poster</div>

        <a-scene embedded arjs>
            <a-marker type="pattern" url="https://nightsurfer88.github.io/AR_poster/Assets/marker.patt">
                <!-- Container for video and play button -->
                <a-entity position="0 0 0">
                    <!-- Use the a-video component to display an MP4 video -->
                    <a-video
                        position="0 0 0"
                        scale="3.5 2 1"
                        rotation="-90 0 0"
                        src="https://nightsurfer88.github.io/AR_poster/Assets/asset.mp4"
                        id="video"
                        muted
                        autoplay
                    ></a-video>
                    <!-- Play button -->
                    <a-image
                        position="0 0.3 0"
                        rotation="-90 0 0"
                        scale="0.5 0.5 0.5"
                        src="https://nightsurfer88.github.io/AR_poster/Assets/play_button.png" 
                        id="play-button"
                        visible="false"
                    ></a-image>
                </a-entity>
            </a-marker>
            <a-entity camera></a-entity>
        </a-scene>
        <script>
            // Wrap the event listener registration in a function
            function initializeAR() {
                const videoElement = document.getElementById("video");
                const playButton = document.getElementById("play-button");
        
                videoElement.addEventListener("playing", () => {
                    // Video is playing, hide the play button
                    playButton.setAttribute("visible", false);
                });
        
                videoElement.addEventListener("ended", () => {
                    // Video has ended, show the play button again
                    playButton.setAttribute("visible", true);
                });
        
                const marker = document.querySelector('a-marker[type="pattern"]');
        
                if (marker) {
                    marker.addEventListener("markerFound", () => {
                        // Show the play button when marker is found and the video is not playing
                        if (!videoElement.paused) {
                            playButton.setAttribute("visible", false);
                        } else {
                            playButton.setAttribute("visible", true);
                        }
                    });
                }
        
                // Add a click event listener to the play button
                playButton.addEventListener("click", () => {
                    // Check if the video is not playing
                    if (videoElement.paused) {
                        // Play the video and update the visible state of the play button
                        videoElement.play();
                    }
                });
            }
        
            // Add an event listener to call the initialization function when the page has finished loading
            document.addEventListener("DOMContentLoaded", initializeAR);
        </script>
    </body>
</html>
